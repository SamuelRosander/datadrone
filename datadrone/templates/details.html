{% extends "layout.html" %}

{% block body %}

<h3>{{ item.itemname }}</h3>

Search between:<br>
<input type="text"><br>
<input type="text"><input type="button">

<br><br>

First: {{ stats['first'] }}<br>
Last: {{ stats['last'] }}<br>
Total: {{ stats['total'] }}<br>
Avg/day: {{ stats['average_a_day'] }}<br>
Max in a day: {{ stats['max_in_a_day'] }} ({{ stats['max_in_a_day-date'] }})<br>
Longest without: {{ stats['longest_without'] }} ({{ stats['longest_without_start'] }} - {{ stats['longest_without_end'] }})<br>
Days since last: {{ stats['days_since_last'] }}<br>
Total today: {{ stats['total_today'] }}

<br><br>

<div id="map"></div>
<script>
  function initMap() {
    var map = new google.maps.Map(document.getElementById('map'), {
        zoom: 5,
        center: {lat: 57.367698, lng: 14.265648}
    });

    var labels = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';

    var markers = locations.map(function(location, i) {
      return new google.maps.Marker({
        position: location,
        label: labels[i % labels.length]
      });
    });

    var markerCluster = new MarkerClusterer(map, markers, {imagePath: 'https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/m'});
  }

  var locations = [
    {% for entry in entries %}
      {% if entry.latitude and entry.longitude %}
        { lat: {{entry.latitude }}, lng: {{ entry.longitude }} },
      {% endif %}
    {% endfor %}
  ];

</script>
<script src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js">
</script>
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCv89Lm44klib2QbXjtUy38jFosKg5ET0g&callback=initMap">
</script>

<br><br>

{% for entry in entries[::-1] %}
  <a href="{{ url_for('entry', entry_id=entry.entry_id)}}">{{ entry.timestamp }}</a>
  {% for entrytag in entry.entrytags %}
    {{ entrytag.tag.name }}
  {% endfor %}
  {% if entry.comment %}
    {{ entry.comment }}
  {% endif %}
  <br>
{% endfor %}

{% endblock%}
